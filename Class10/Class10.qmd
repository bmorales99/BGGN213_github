---
title: "Class10"
author: "Bobbie Morales A15443382"
format: pdf
---

```{r}
candy_file <- "candy-data.csv"
candy = read.csv("candy-data.csv", row.names = 1)
head(candy)
```
>Q1. How many different candy types are in this dataset?

```{r}
nrow(candy)
```
There are 85 different candy types in this dataset. 

>Q2. How many fruity candy types are in the dataset?
The functions dim(), nrow(), table() and sum() may be useful for answering the first 2 questions.

```{r}
sum(candy$fruity)
```

There are 38 candy types. 

>Q3. What is your favorite candy in the dataset and what is it’s winpercent value?

```{r}
candy["Almond Joy",]$winpercent
```


My favorite candy is almondjoy, the winpercent is 

>Q4. What is the winpercent value for “Kit Kat”?

```{r}
candy["Kit Kat",]$winpercent
```
The winpercent for kit kat is 76.7686.

>Q5. What is the winpercent value for “Tootsie Roll Snack Bars”?

```{r}
candy["Tootsie Roll Snack Bars",]$winpercent 
```

The winpercent is 49.6535 

```{r}
library(flextable)
flextable :: flextable( head(candy))
```


```{r,message=FALSE}
library(dplyr)

candy |> nrow()
```

```{r}
candy |> select(winpercent)
```

```{r}
win <- candy$winpercent
win.mean <- mean(win)
round(win.mean)
```

```{r}
candy %>% select(winpercent)
```

```{r}
library("skimr")
skim(candy)
```


>Q6. Is there any variable/column that looks to be on a different scale to the majority of the other columns in the dataset?

The winpercent variable is on a different scale than the others.

>Q7. What do you think a zero and one represent for the candy$chocolate column?

It represents a hit or no hit. The zero tells us how many people did not choose it while the 1 tells us how many people did choose it 

```{r}
hist(candy$chocolate)
```


>>Q8. Plot a histogram of winpercent values

```{r}
library(ggplot2)
ggplot(candy)+
  aes(winpercent)+
  geom_histogram()
```

>Q9. Is the distribution of winpercent values symmetrical?

```{r}
ggplot(candy)+
  aes(winpercent)+
  geom_density()
```


no it is not symmetrical 

>Q10. Is the center of the distribution above or below 50%?

```{r}
mean(candy$winpercent)
```
The mean of the data is 50% while the median is 47%. 

```{r}
summary(candy$winpercent)
```

>Q11. On average is chocolate candy higher or lower ranked than fruit candy?

The fruity candy is lower ranked than chocolate.

```{r}
#1. Find all chocolate candy in the dataset
choc.inds <- as.logical(candy$chocolate==1)
choc.candy <- candy[choc.inds,]
choc.candy
#2. Extract their `winpercent` values 
choc.win <- choc.candy$winpercent
#3. Find the mean of these values
choc.mean <- mean(choc.win)
#4-6 Do the same for fruity candy 
fruit.win <- candy[candy$fruity==1,]$winpercent
fruity.mean <- mean(fruit.win)

#7 which mean value is higher
choc.mean
fruity.mean
```


>Q12. Is this difference statistically significant?

```{r}
t.test(choc.win, fruit.win)
```

Yes, the finding is significant. The p value is 2.871e-08

>Q13. What are the five least liked candy types in this set?

```{r}
candy %>% arrange(winpercent) %>% tail(5)
```

>Q14. What are the top 5 all time favorite candy types out of this set?

```{r}
candy %>% arrange(winpercent) %>% head(5)
```


>Q15. Make a first barplot of candy ranking based on winpercent values.
>Q16. This is quite ugly, use the reorder() function to get the bars sorted by winpercent?


```{r}
ggplot(candy) + 
  aes(winpercent, reorder(rownames(candy), winpercent)) + 
  geom_col()
```

add some color 

```{r}

my_cols <- rep("black", nrow(candy))
my_cols[candy$chocolate==1] <- "chocolate"
my_cols[candy$bar==1] <- "brown"
my_cols[candy$fruity==1] <- "pink"
ggplot(candy) + 
  aes(x = winpercent,
      y = reorder(rownames(candy), winpercent),
      fill=my_cols) + 
  geom_col(fill=my_cols)
```

> Q17. What is the worst ranked chocolate candy?

The worst ranked chocolate candy is sixlets.

>Q18. What is the best ranked fruity candy?

The best ranked fruity candy is starburst

##Winpercent vs Pricepercent 

```{r}
library(ggrepel)
my_cols[candy$fruity==1] <- "red"
ggplot(candy) + 
  aes(winpercent, pricepercent, label =rownames(candy)) + 
  geom_point(col=my_cols)+
  geom_text_repel(col=my_cols)
```

>Q19. Which candy type is the highest ranked in terms of winpercent for the least money - i.e. offers the most bang for your buck?

Reese's miniatures have the highest winpercent and lowest pricpercent. Reeses peanut butter cups have a slightly higher winpercent than miniatures but are more expensive.

>Q20. What are the top 5 most expensive candy types in the dataset and of these which is the least popular?

The top 5 most expensive candies are Nik L Nip, Ring Pop, Nestle Smarties, Mr. goodbar and hershey's milk chocolate.Nik L Nip is the least popular 


##correlation structure 

>Q22. Examining this plot what two variables are anti-correlated (i.e. have minus values)?

Chocolate and fruity candies are anti-correlated.

>Q23. Similarly, what two variables are most positively correlated?

Chocolate and bars are most positively correlated.

```{r}
cij <- cor(candy)
```


```{r}
library(corrplot)
corrplot(cij)
```

##principal component analysis 

The main function in base R for this is `prcomp()` and we want to set `scale=TRUE` here: 

```{r}
pca <- prcomp(candy, scale = TRUE)
summary(pca)
```
 Lets look at our first main result figure - the "PC Plot" pr PC1 vs PC2
 
```{r}
ggplot (pca$x) + 
  aes(PC1, PC2, label = rownames(pca$x)) + 
  geom_point(col = my_cols) +
geom_text_repel(col=my_cols)
```
 
Don't forget about your variable "loadings" - how the original variables contribute to your new PCs 

```{r}
ggplot(pca$rotation) + 
  aes(PC1, rownames(pca$rotation)) + 
  geom_col()
```

>Q24. What original variables are picked up strongly by PC1 in the positive direction? Do these make sense to you?

pluribus and fruity are picked up strongly in PC1 in the positive direction. This makes sense because fruity candy such as starburst usually comes in a bag.

"AlphaFold DB provides open access to over 200 million protein structure predictions to accelerate scientific research."